/*
    *
    * Wijmo Library 5.20163.254
    * http://wijmo.c1.grapecity.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * 
    * http://wijmo.c1.grapecity.com/license/
    *
    */
var wijmo;(function(n){var t;(function(t){var i;(function(i){'use strict';var r=function(){function i(){}return i.export=function(t,i){n._deprecated('FlexGridXlsxConverter.export','FlexGridXlsxConverter.save');var r=this.toWorkbookOM(t,i);return n.xlsx.XlsxConverter.export(r)},i.import=function(t,i,r,u){n._deprecated('FlexGridXlsxConverter.import','FlexGridXlsxConverter.load');var f=n.xlsx.XlsxConverter.import(t);this.fromWorkbookOM(f,i,r,u)},i.toWorkbookOM=function(t,i){n._deprecated('FlexGridXlsxConverter.toWorkbookOM','FlexGridXlsxConverter.save');var r={sheets:[],creator:'',created:new Date,lastModifiedBy:'',modified:new Date,activeWorksheet:0},u,f;if(i&&i.activeWorksheet!=null&&i.activeWorksheet>0&&(r.activeWorksheet=i.activeWorksheet),n.isArray(t))for(u=0;u<t.length;u++)f=t[u],this._exportFlexGrid(f,r,i);else this._exportFlexGrid(t,r,i);return r},i.fromWorkbookOM=function(i,r,u,f){n._deprecated('FlexGridXlsxConverter.fromWorkbookOM','FlexGridXlsxConverter.load');var ui=u?u.includeColumnHeader:!0,p=u?u.includeColumnHeader:!0,dt=1,g=0,e=0,h=0,it,rt,v,ut,b,w,ft,pt,nt,gt,s,l,ni,k,et,c,ot,st,ti,wt,a,ht,d,y,ii,ct,o,bt,kt,lt,ri,tt,at=!1,vt={},yt;if(r.itemsSource=null,r.columns.clear(),r.rows.clear(),r.frozenColumns=0,r.frozenRows=0,i.sheets.length!==0)for(f&&(dt=i.sheets.length);g<dt;g++){for(bt={},kt={},h=0,ut=[],lt=[],l=i.sheets[g],ui&&(h=1,l.rows.length<=1&&(p=!1,h=0),pt=l.rows[0]),k=this._getColumnCount(l.rows),ni=this._getRowCount(l.rows,k),ti=l.summaryBelow,g>0&&(ii=document.createElement('div'),r=new t.FlexGrid(ii)),v=l.columns||l.cols,e=0;e<k;e++)r.columns.push(new t.Column),!v[e]||(isNaN(+v[e].width)||(r.columns[e].width=+v[e].width),v[e].visible||v[e].visible==undefined||(r.columns[e].visible=!!v[e].visible),v[e].style&&!!v[e].style.wordWrap&&(r.columns[e].wordWrap=v[e].style.wordWrap));for(;h<ni;h++){if(et=!1,yt=!0,s=l.rows[h],s)for(ot=h+1;ot<l.rows.length;)if(st=l.rows[ot],st){(isNaN(s.groupLevel)&&!isNaN(st.groupLevel)||!isNaN(s.groupLevel)&&s.groupLevel<st.groupLevel)&&(et=!0);break}else ot++;for(et&&!ti?(a&&(a.isCollapsed=at),a=new t.GroupRow,a.isReadOnly=!1,at=s.collapsed==null?!1:s.collapsed,a.level=isNaN(s.groupLevel)?0:s.groupLevel,vt[a.level]=at,this._checkParentCollapsed(vt,a.level)&&a._setFlag(t.RowColFlags.ParentCollapsed,!0),r.rows.push(a)):(wt=new t.Row,s&&this._checkParentCollapsed(vt,s.groupLevel)&&wt._setFlag(t.RowColFlags.ParentCollapsed,!0),r.rows.push(wt)),!s||!s.height||isNaN(s.height)||(r.rows[p?h-1:h].height=s.height),e=0;e<k;e++)if(s){if(c=s.cells[e],y=c?c.formula:undefined,y&&y[0]!=='='&&(y='='+y),y=y?this._parseToFlexSheetFormula(y):undefined,r.setCellData(p?h-1:h,e,y&&f?y:this._getItemValue(c)),!et&&c&&c.value!=null&&c.value!==''&&this._setColumn(ut,e,c),ct=h*k+e,o=c?c.style:undefined,o){if(yt=yt&&!!o.wordWrap,ri=this._getItemType(c),o.hAlign)tt=n.xlsx.Workbook._parseHAlignToString(n.asEnum(o.hAlign,n.xlsx.HAlign));else switch(ri){case n.DataType.Number:tt='right';break;case n.DataType.Boolean:tt='center';break;default:tt='left'}bt[ct]={fontWeight:o.font&&o.font.bold?'bold':'none',fontStyle:o.font&&o.font.italic?'italic':'none',textDecoration:o.font&&o.font.underline?'underline':'none',textAlign:tt,fontFamily:o.font&&o.font.family?o.font.family:'',fontSize:o.font&&o.font.size?o.font.size+'px':'',color:o.font&&o.font.color?o.font.color:'',backgroundColor:o.fill&&o.fill.color?o.fill.color:'',format:n.xlsx.Workbook._parseExcelFormat(c)};o.font&&lt.indexOf(o.font.family)===-1&&lt.push(o.font.family)}if(c&&n.isNumber(c.rowSpan)&&n.isNumber(c.colSpan))for(it=h;it<h+c.rowSpan;it++)for(rt=e;rt<e+c.colSpan;rt++)ct=it*k+rt,kt[ct]=new t.CellRange(h,e,h+c.rowSpan-1,e+c.colSpan-1)}else r.setCellData(p?h-1:h,e,''),this._setColumn(ut,e,undefined);s&&(this._checkParentCollapsed(vt,s.groupLevel)||s.visible||s.visible==undefined||(r.rows[p?h-1:h].visible=s.visible),r.rows[p?h-1:h].wordWrap=!!s.style&&!!s.style.wordWrap||yt)}for(a&&(a.isCollapsed=at),l.frozenPane&&(ht=l.frozenPane.columns,n.isNumber(ht)&&!isNaN(ht)&&(r.frozenColumns=ht),d=l.frozenPane.rows,n.isNumber(d)&&!isNaN(d)&&(r.frozenRows=p&&d>0?d-1:d)),e=0;e<r.columnHeaders.columns.length;e++)b=ut[e],w=r.columns[e],w.isRequired=!1,p?(nt=pt?pt.cells[e]:undefined,nt&&nt.value?(gt=n.xlsx.Workbook._parseExcelFormat(nt),ft=n.Globalize.format(nt.value,gt)):ft=this._numAlpha(e)):ft=this._numAlpha(e),w.header=ft,b&&(b.dataType===n.DataType.Boolean&&(w.dataType=b.dataType),w.format=b.format,w.align=b.hAlign,w.wordWrap=w.wordWrap||b.wordWrap);f&&(r.wj_sheetInfo={name:l.name,visible:l.visible!==!1,styledCells:bt,mergedRanges:kt,fonts:lt});f&&g>0&&f.push(r)}},i.save=function(i,r,u){var nt=new n.xlsx.Workbook,c=new n.xlsx.WorkSheet,tt=new n.xlsx.WorkbookFrozenPane,ft=r&&r.includeColumnHeaders!=null?r.includeColumnHeaders:!0,g=r&&r.includeRowHeaders!=null?r.includeRowHeaders:!1,w=r&&r.includeCellStyles!=null?r.includeCellStyles:!0,st=r?r.activeWorksheet:null,l=r?r.includeColumns:null,o,v,b,y,p,s,f,e,it,a,d,et,k,rt=0,ut=0,ot=0,h=0;if(it=i.wj_sheetInfo,c.name=r?r.sheetName:'',c.visible=r?r.sheetVisible!==!1:!0,s=[],!it&&w&&(a=document.createElement('div'),a.style.visibility='hidden',i.hostElement.appendChild(a)),g){for(f=0;f<i.rowHeaders.rows.length;f++)for(s[f]=[],e=0;e<i.rowHeaders.columns.length;e++)b=i._getBindingColumn(i.rowHeaders,f,i.rowHeaders.columns[e]),y=this._getColumnSetting(b,i.columnHeaders.columns.defaultSize),s[f][e]=y,f===0&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p,e));h=e}if(ft&&i.columnHeaders.rows.length>0){for(f=0;f<i.columnHeaders.rows.length;f++){for(s[f]||(s[f]=[]),e=0;e<i.columnHeaders.columns.length;e++)b=i._getBindingColumn(i.columnHeaders,f,i.columnHeaders.columns[e]),y=this._getColumnSetting(b,i.columnHeaders.columns.defaultSize),s[f][h+e]=y,f===0&&(!l||l(b))&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p));h=0;o={};v=new n.xlsx.WorkbookRow;g&&(h=this._parseFlexGridRowToSheetRow(i.topLeftCells,o,f,0,s,w,a,!1,0,l));this._parseFlexGridRowToSheetRow(i.columnHeaders,o,f,h,s,w,a,!1,0,l);o.cells.length>0&&(v._deserialize(o),c._addWorkbookRow(v,f))}ut=f}else for(s[0]||(s[0]=[]),e=0;e<i.columnHeaders.columns.length;e++)b=i._getBindingColumn(i.columnHeaders,0,i.columnHeaders.columns[e]),y=this._getColumnSetting(b,i.columnHeaders.columns.defaultSize),s[0][h+e]=y,(!l||l(b))&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p));for(f=0;f<i.cells.rows.length;f++)(h=0,o={},v=new n.xlsx.WorkbookRow,d=i.rows[f],d instanceof t._NewRowTemplate)||(k=d instanceof t.GroupRow,k&&(et=n.tryCast(d,t.GroupRow),rt=et.level+1),g&&(h=this._parseFlexGridRowToSheetRow(i.rowHeaders,o,f,0,s,w,a,k,rt,l)),this._parseFlexGridRowToSheetRow(i.cells,o,f,h,s,w,a,k,rt,l),o.cells.length>0&&(v._deserialize(o),c._addWorkbookRow(v,ut+f)));for(ot=i.cells.rows.length,f=0;f<i.columnFooters.rows.length;f++)h=0,o={},v=new n.xlsx.WorkbookRow,d=i.columnFooters.rows[f],k=d instanceof t.GroupRow,g&&(h=this._parseFlexGridRowToSheetRow(i.rowHeaders,o,f,0,s,w,a,k,0,l)),this._parseFlexGridRowToSheetRow(i.columnFooters,o,f,h,s,w,a,k,0,l),o.cells.length>0&&(v._deserialize(o),c._addWorkbookRow(v,ut+ot+f));return tt.rows=ft?i.frozenRows+i.columnHeaders.rows.length:i.frozenRows,tt.columns=g?i.frozenColumns+i.rowHeaders.columns.length:i.frozenColumns,c.frozenPane=tt,nt._addWorkSheet(c),!it&&w&&i.hostElement.removeChild(a),nt.activeWorksheet=st,u&&nt.save(u),nt},i.load=function(t,i,r){var u,f,e=this;if(i instanceof Blob)f=new FileReader,f.onload=function(){var i=n.xlsx.Workbook._base64EncArr(new Uint8Array(f.result));u=new n.xlsx.Workbook;u.load(i);e._loadToFlexGrid(t,u,r)},f.readAsArrayBuffer(i);else if(i instanceof n.xlsx.Workbook)e._loadToFlexGrid(t,i,r);else{if(i instanceof ArrayBuffer)i=n.xlsx.Workbook._base64EncArr(new Uint8Array(i));else if(!n.isString(i))throw'Invalid workbook.';u=new n.xlsx.Workbook;u.load(i);e._loadToFlexGrid(t,u,r)}},i._exportFlexGrid=function(i,r,u){var d=[],s=[],o={columns:[],rows:[],summaryBelow:!1},tt=u?u.includeColumnHeaders!=null?u.includeColumnHeaders:u.includeColumnHeader!=null?u.includeColumnHeader:!0:!0,b=u?u.includeRowHeaders!=null?u.includeRowHeaders:!1:!1,w=u?u.includeCellStyles!=null?u.includeCellStyles:u.needGetCellStyle!=null?u.needGetCellStyle:!0:!0,a=u?u.includeColumns:null,h,v,c,f,e,p,y,g,it,k,nt=0,rt=0,l=0;if(p=i.wj_sheetInfo,o.name=p?p.name:'',o.visible=p?p.visible!==!1:!0,o.style={font:{size:14}},o.columns=[],!p&&w&&(y=document.createElement('div'),y.style.visibility='hidden',i.hostElement.appendChild(y)),b){for(f=0;f<i.rowHeaders.rows.length;f++)for(s[f]=[],o.columns[f]=[],e=0;e<i.rowHeaders.columns.length;e++)v=i._getBindingColumn(i.rowHeaders,f,i.rowHeaders.columns[e]),c=this._getColumnSetting(v,i.columnHeaders.columns.defaultSize),s[f][e]=c,o.columns[f][e]=c;l=e}if(tt&&i.columnHeaders.rows.length>0){for(f=0;f<i.columnHeaders.rows.length;f++){for(s[f]||(s[f]=[]),o.columns[f]||(o.columns[f]=[]),e=0;e<i.columnHeaders.columns.length;e++)v=i._getBindingColumn(i.rowHeaders,f,i.columnHeaders.columns[e]),c=this._getColumnSetting(v,i.columnHeaders.columns.defaultSize),s[f][l+e]=c,(!a||a(v))&&o.columns[f].push(c);l=0;h={};b&&(l=this._parseFlexGridRowToSheetRow(i.topLeftCells,h,f,0,s,w,y,!1,0,a));this._parseFlexGridRowToSheetRow(i.columnHeaders,h,f,l,s,w,y,!1,0,a);h.cells.length>0&&(d[f]=h)}rt=f}else for(s[0]||(s[0]=[]),o.columns[f]||(o.columns[f]=[]),e=0;e<i.columnHeaders.columns.length;e++)v=i.columnHeaders.columns[e],c=this._getColumnSetting(v,i.columnHeaders.columns.defaultSize),s[0][l+e]=c,(!a||a(v))&&o.columns[f].push(c);for(o.columns=s,f=0;f<i.cells.rows.length;f++)l=0,h={},g=i.rows[f],k=g instanceof t.GroupRow,k&&(it=n.tryCast(g,t.GroupRow),nt=it.level+1),b&&(l=this._parseFlexGridRowToSheetRow(i.rowHeaders,h,f,0,s,w,y,k,nt,a)),this._parseFlexGridRowToSheetRow(i.cells,h,f,l,s,w,y,k,nt,a),h.cells.length>0&&(d[rt+f]=h);o.rows=d;o.frozenPane={rows:tt?i.frozenRows+i.columnHeaders.rows.length:i.frozenRows,columns:b?i.frozenColumns+i.rowHeaders.columns.length:i.frozenColumns};r.sheets.push(o);!p&&w&&i.hostElement.removeChild(y)},i._loadToFlexGrid=function(i,r,u){var ti=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,y=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,vt=u&&u.sheetIndex!=null&&!isNaN(u.sheetIndex)?u.sheetIndex:0,ii=u?u.sheetName:null,ri=u?u.sheetVisible:!0,ui=u&&(u.sheetIndex!=null&&!isNaN(u.sheetIndex)||u.sheetName!=null||u.sheetVisible!=null),f=0,s=0,nt,tt,a,it,w,p,rt,yt,d,kt,o,c,dt,b,ut,h,ft,et,gt,pt,l,ot,k,v,st,e,wt,bt,ht,ni,g,ct=!1,lt={},at;if(i.itemsSource=null,i.columns.clear(),i.rows.clear(),i.frozenColumns=0,i.frozenRows=0,wt={},bt={},s=0,it=[],ht=[],vt<0||vt>=r.sheets.length)throw'The sheet index option is out of the sheet range of current workbook.';if(c=r.sheets[vt],c.rows!=null){for(ti&&(s=1,c.rows.length<=1&&(y=!1,s=0),yt=c.rows[0]),b=this._getColumnCount(c.rows),dt=this._getRowCount(c.rows,b),gt=c.summaryBelow,a=c.columns||c.cols,f=0;f<b;f++)i.columns.push(new t.Column),!a[f]||(isNaN(+a[f].width)||(i.columns[f].width=+a[f].width),a[f].visible||a[f].visible==undefined||(i.columns[f].visible=!!a[f].visible),a[f].style&&!!a[f].style.wordWrap&&(i.columns[f].wordWrap=a[f].style.wordWrap));for(;s<dt;s++){if(ut=!1,at=!0,o=c.rows[s],o)for(ft=s+1;ft<c.rows.length;)if(et=c.rows[ft],et){(isNaN(o.groupLevel)&&!isNaN(et.groupLevel)||!isNaN(o.groupLevel)&&o.groupLevel<et.groupLevel)&&(ut=!0);break}else ft++;for(ut&&!gt?(l&&(l.isCollapsed=ct),l=new t.GroupRow,l.isReadOnly=!1,ct=o.collapsed==null?!1:o.collapsed,l.level=isNaN(o.groupLevel)?0:o.groupLevel,lt[l.level]=ct,this._checkParentCollapsed(lt,l.level)&&l._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(l)):(pt=new t.Row,o&&this._checkParentCollapsed(lt,o.groupLevel)&&pt._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(pt)),!o||!o.height||isNaN(o.height)||(i.rows[y?s-1:s].height=o.height),f=0;f<b;f++)if(o){if(h=o.cells[f],v=h?h.formula:undefined,v&&v[0]!=='='&&(v='='+v),v=v?this._parseToFlexSheetFormula(v):undefined,i.setCellData(y?s-1:s,f,v&&ui?v:this._getItemValue(h)),ut||this._setColumn(it,f,h),st=s*b+f,e=h?h.style:undefined,e){if(at=at&&!!e.wordWrap,ni=this._getItemType(h),e.hAlign)g=n.xlsx.Workbook._parseHAlignToString(n.asEnum(e.hAlign,n.xlsx.HAlign));else switch(ni){case n.DataType.Number:g='right';break;case n.DataType.Boolean:g='center';break;default:g='left'}wt[st]={fontWeight:e.font&&e.font.bold?'bold':'none',fontStyle:e.font&&e.font.italic?'italic':'none',textDecoration:e.font&&e.font.underline?'underline':'none',textAlign:g,fontFamily:e.font&&e.font.family?e.font.family:'',fontSize:e.font&&e.font.size?e.font.size+'px':'',color:e.font&&e.font.color?e.font.color:'',backgroundColor:e.fill&&e.fill.color?e.fill.color:'',format:n.xlsx.Workbook._parseExcelFormat(h)};e.font&&ht.indexOf(e.font.family)===-1&&ht.push(e.font.family)}if(h&&n.isNumber(h.rowSpan)&&h.rowSpan>0&&n.isNumber(h.colSpan)&&h.colSpan>0&&(h.rowSpan>1||h.colSpan>1))for(nt=s;nt<s+h.rowSpan;nt++)for(tt=f;tt<f+h.colSpan;tt++)st=nt*b+tt,bt[st]=new t.CellRange(s,f,s+h.rowSpan-1,f+h.colSpan-1)}else i.setCellData(y?s-1:s,f,''),this._setColumn(it,f,undefined);o&&(this._checkParentCollapsed(lt,o.groupLevel)||o.visible||o.visible==undefined||(i.rows[y?s-1:s].visible=o.visible),i.rows[y?s-1:s].wordWrap=!!o.style&&!!o.style.wordWrap||at)}for(l&&(l.isCollapsed=ct),c.frozenPane&&(ot=c.frozenPane.columns,n.isNumber(ot)&&!isNaN(ot)&&(i.frozenColumns=ot),k=c.frozenPane.rows,n.isNumber(k)&&!isNaN(k)&&(i.frozenRows=y&&k>0?k-1:k)),f=0;f<i.columnHeaders.columns.length;f++)w=it[f],p=i.columns[f],p.isRequired=!1,y?(d=yt?yt.cells[f]:undefined,d&&d.value?(kt=n.xlsx.Workbook._parseExcelFormat(d),rt=n.Globalize.format(d.value,kt)):rt=this._numAlpha(f)):rt=this._numAlpha(f),p.header=rt,w&&(w.dataType===n.DataType.Boolean&&(p.dataType=w.dataType),p.format=w.format,p.align=w.hAlign,p.wordWrap=p.wordWrap||w.wordWrap);i.wj_sheetInfo={name:ii||c.name,visible:ri===!0?!0:c.visible!==!1,styledCells:wt,mergedRanges:bt,fonts:ht}}},i._parseFlexGridRowToSheetRow=function(t,i,r,u,f,e,o,s,h,c){var b,a,d,l,v,y,tt,ut,it,g,ot,w,k,ft,et,rt,p,ht=!1,st,nt,ct;for(b=t.grid,rt=b.wj_sheetInfo,a=t.rows[r],ct=a.recordIndex!=null?a.recordIndex:0,i.cells||(i.cells=[]),i.visible=a.isVisible,i.height=a.renderHeight||t.rows.defaultSize,i.groupLevel=s?h-1:h,s&&(i.collapsed=a.isCollapsed),a.wordWrap&&(i.style={wordWrap:a.wordWrap}),(a.constructor===n.grid.Row||a.constructor===n.grid._NewRowTemplate||n.grid.detail&&a.constructor===n.grid.detail.DetailRow||n.grid.multirow&&a.constructor===n.grid.multirow._MultiRow)&&(ht=!0),l=0;l<t.columns.length;l++)if(et=1,ft=1,nt=!1,st=b._getBindingColumn(t,r,t.columns[l]),k=null,rt&&t===b.cells?(ot=r*t.columns.length+l,rt.mergedRanges&&(k=rt.mergedRanges[ot]),rt.styledCells&&(w=rt.styledCells[ot])):e&&(w=this._getCellStyle(t,o,r,l)||{}),k||(k=b.getMergedRange(t,r,l,!1)),k?r===k.topRow&&l===k.leftCol&&(ft=k.bottomRow-k.topRow+1,et=this._getColSpan(t,k,c),nt=!0):nt=!0,!c||c(st))if(d=f[ct][l+u],ht||s?(y=nt?t.getCellData(r,l,!0):null,tt=nt?t.getCellData(r,l,!1):null,it=!1,y&&n.isString(y)&&y.length>1&&y[0]==='='&&(it=!0),p=n.isDate(tt),v=w&&w.format?n.xlsx.Workbook._parseCellFormat(w.format,p):d&&d.style&&d.style.format?n.xlsx.Workbook._parseCellFormat(d.style.format,p):null,v||(p?v='m/d/yyyy':n.isNumber(tt)&&!st.dataMap?v=n.isInt(tt)?'#,##0':'#,##0.00':it?(g=y.toLowerCase(),g==='=now()'?(v='m/d/yyyy h:mm',p=!0):g==='=today()'||g.substring(0,g.indexOf('('))==='=date'?(v='m/d/yyyy',p=!0):g.substring(0,g.indexOf('('))==='=time'&&(v='h:mm AM/PM',p=!0)):v='General')):(y=nt?b.columnHeaders.getCellData(0,l,!0):null,v='General'),t===b.cells&&s&&a.hasChildren&&l===b.columns.firstVisibleIndex){if(y?ut=y:nt&&(ut=a.getGroupHeader().replace(/<\/?\w+>/g,'')),ut==null&&!w)continue;p=n.isDate(ut);i.cells.push({value:ut,isDate:p,formula:it?this._parseToExcelFormula(y,p):null,colSpan:et,rowSpan:ft,style:this._extend(this._parseCellStyle(w),{format:v,font:{bold:!0},hAlign:n.xlsx.HAlign.Left,indent:h-1})})}else i.cells.push({value:it?undefined:v==='General'?y:tt,isDate:p,formula:it?this._parseToExcelFormula(y,p):null,colSpan:l<b.columns.firstVisibleIndex?1:et,rowSpan:ft,style:this._extend(this._parseCellStyle(w),{format:v,hAlign:w&&w.textAlign?n.xlsx.Workbook._parseStringToHAlign(w.textAlign):n.isDate(tt)&&d.style.hAlign==null?n.xlsx.HAlign.Left:n.asEnum(d.style.hAlign,n.xlsx.HAlign,!0),vAlign:ft>1?t===b.cells?n.xlsx.VAlign.Top:n.xlsx.VAlign.Center:null})});return u+l},i._parseCellStyle=function(t){var i=t&&t.fontSize?+t.fontSize.substring(0,t.fontSize.indexOf('px')):null;return isNaN(i)&&(i=null),{font:{bold:t&&t.fontWeight&&(t.fontWeight==='bold'||!isNaN(+t.fontWeight)&&+t.fontWeight>=700),italic:t&&t.fontStyle&&t.fontStyle==='italic',underline:t&&t.textDecoration&&t.textDecoration==='underline',family:t?this._parseToExcelFontFamily(t.fontFamily):null,size:i,color:t&&t.color?t.color:null},fill:{color:t&&t.backgroundColor?t.backgroundColor:null},borders:t?this._parseBorder(t):null,hAlign:t&&t.textAlign?n.xlsx.Workbook._parseStringToHAlign(t.textAlign):null}},i._parseBorder=function(n){var t,i;for(var r in{Left:0,Right:0,Top:0,Bottom:0})i=this._parseEgdeBorder(n,r),i&&(t||(t={}),t[r.toLowerCase()]=i);return t},i._parseEgdeBorder=function(t,i){var r,f='border'+i+'Color',u=t['border'+i+'Style'],e;if(u&&u!=='none'&&u!=='hidden'){r={};u=u.toLowerCase();switch(u){case'dotted':r.style=n.xlsx.BorderStyle.Dotted;break;case'dashed':r.style=n.xlsx.BorderStyle.Dashed;break;case'double':r.style=n.xlsx.BorderStyle.Double;break;default:r.style=n.xlsx.BorderStyle.Thin}t[f]&&(e=new n.Color(t[f]),r.color=e.toString())}return r},i._parseToExcelFontFamily=function(n){var t;return n&&(t=n.split(','),t&&t.length>0&&(n=t[0].replace(/\"|\'/g,''))),n},i._parseToExcelFormula=function(t,i){var u=t.substring(1,t.indexOf('(')).toLowerCase(),r;switch(u){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(')'))+', 1)';break;case'text':r=t.substring(t.lastIndexOf(','),t.lastIndexOf('\"'));r=n.xlsx.Workbook._parseCellFormat(r.substring(r.lastIndexOf('\"')+1),i);t=t.substring(0,t.lastIndexOf(',')+1)+'\"'+r+'\")'}return t},i._parseToFlexSheetFormula=function(t){var u=t.substring(1).match(/\W+(\w+)\(/),r,f,e,o,i;f=u&&u.length===2?u[1]:t.substring(1,t.indexOf('('));e=t.indexOf(f);switch(f.toLowerCase()){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(','))+')';break;case'text':r=t.substring(e);i=r.substring(r.indexOf('\"'),r.lastIndexOf('\"'));i=i.substring(i.lastIndexOf('\"')+1);o=i.indexOf('0')>-1?0:'';i=n.xlsx.Workbook._parseExcelFormat({value:o,style:{format:i}});i=i.replace(/m+/g,function(n){return n.toUpperCase()}).replace(/Y+/g,function(n){return n.toLowerCase()}).replace(/M+:?|:?M+/gi,function(n){return n.indexOf(':')>-1?n.toLowerCase():n});t=t.substring(0,e)+r.substring(0,r.indexOf('\"')+1)+i+'\")'}return t},i._getColumnSetting=function(t,i){var r=t.renderWidth;return r=r||i,{autoWidth:!0,width:r,visible:t.visible,style:{format:t.format?n.xlsx.Workbook._parseCellFormat(t.format,t.dataType===n.DataType.Date):'',hAlign:n.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(t.getAlignment())),wordWrap:t.wordWrap}}},i._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},i._getColumnCount=function(t){for(var f=0,i=0,r,u=0;u<t.length;u++)r=t[u]&&t[u].cells?t[u].cells:[],r&&r.length>0&&(i=r.length,n.isInt(r[i-1].colSpan)&&r[i-1].colSpan>1&&(i=i+r[i-1].colSpan-1),i>f&&(f=i));return f},i._getRowCount=function(t,i){for(var f=t.length,u=f-1,o=0,e,s,r;o<i;o++)n:for(;u>=0;u--)if(e=t[u],s=e&&e.cells?e.cells:[],r=s[o],r&&(r.value!=null&&r.value!==''||n.isInt(r.rowSpan)&&r.rowSpan>1)){n.isInt(r.rowSpan)&&r.rowSpan>1&&u+r.rowSpan>f&&(f=u+r.rowSpan);break n}return f},i._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+String.fromCharCode(65+n%26)},i._getItemType=function(t){return t===undefined||t===null||t.value===undefined||t.value===null||isNaN(t.value)?undefined:n.getType(t.value)},i._setColumn=function(t,i,r){var f,e,o,u=t[i];u?(f=this._getItemType(r),u.dataType!==f&&u.dataType===n.DataType.Boolean&&f!==n.DataType.Boolean&&(u.dataType=f),r&&r.value!=null&&r.value!==''&&(e=n.xlsx.Workbook._parseExcelFormat(r),e&&u.format!==e&&e!=='General'&&(u.format=e)),r&&r.style&&(r.style.hAlign&&(o=n.xlsx.Workbook._parseHAlignToString(n.asEnum(r.style.hAlign,n.xlsx.HAlign))),u.wordWrap=u.wordWrap&&!!r.style.wordWrap),o||f!==n.DataType.Number||(o='right'),u.hAlign=o):t[i]={dataType:this._getItemType(r),format:n.xlsx.Workbook._parseExcelFormat(r),hAlign:'',wordWrap:!0}},i._getItemValue=function(t){if(t===undefined||t===null||t.value===undefined||t.value===null)return undefined;var i=t.value;return n.isNumber(i)&&isNaN(i)?'':i instanceof Date&&isNaN(i.getTime())?'':i},i._getCellStyle=function(n,t,i,r){try{this._resetCellStyle(t);n.grid.cellFactory.updateCell(n,i,r,t)}catch(u){return undefined}return window.getComputedStyle(t)},i._resetCellStyle=function(n){for(var t in n.style)typeof n.style[t]=='string'&&isNaN(+t)&&(n.style[t]='')},i._extend=function(t,i){var r,u;for(r in i)u=i[r],n.isObject(u)&&t[r]?n.copy(t[r],u):t[r]=u;return t},i._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},i._getColSpan=function(n,t,i){for(var u=0,r=t.leftCol;r<=t.rightCol;r++)(!i||i(n.columns[r]))&&u++;return u},i}();i.FlexGridXlsxConverter=r})(i=t.xlsx||(t.xlsx={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={}))