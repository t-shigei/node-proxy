/*
    *
    * Wijmo Library 5.20163.254
    * http://wijmo.c1.grapecity.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * 
    * http://wijmo.c1.grapecity.com/license/
    *
    */
var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},wijmo;(function(n){var t;(function(t){var i;(function(i){'use strict';function u(t,i,r){var f,o,e;if(r===void 0&&(r=!1),i&&t)for(f in i)o=i[f],e=t[f],n.isObject(o)?((e===undefined||!n.isObject(e)&&r)&&(t[f]=e={}),n.isObject(e)&&u(t[f],o,r)):(e===undefined||r&&o!==undefined)&&(t[f]=o);return t}var r,o,h;(function(n){n[n.ActualSize=0]="ActualSize";n[n.PageWidth=1]="PageWidth";n[n.SinglePage=2]="SinglePage"})(i.ScaleMode||(i.ScaleMode={}));r=i.ScaleMode,function(n){n[n.All=0]="All";n[n.Selection=1]="Selection"}(i.ExportMode||(i.ExportMode={}));o=i.ExportMode;h=function(){function i(){}return i.draw=function(t,i,f,e,o){n.assert(!!t,'The flex argument cannot be null.');n.assert(!!i,'The doc argument cannot be null.');var s=u({},o);u(s,this.DefaultDrawSettings);s.scaleMode=f==null?r.ActualSize:e==null?r.PageWidth:r.SinglePage;try{s.recalculateStarWidths&&t.columns._updateStarSizes(n.pdf.ptToPx(i.width));this._draw(t,i,null,f,e,s)}finally{s.recalculateStarWidths&&t.invalidate(!0)}},i.drawToPosition=function(t,i,f,e,o,s){n.assert(!!t,'The flex argument cannot be null.');n.assert(!!i,'The doc argument cannot be null.');n.assert(!!f,'The point argument cannot be null.');var h=u({},s);u(h,this.DefaultDrawSettings);h.scaleMode=e==null?r.ActualSize:o==null?r.PageWidth:r.SinglePage;try{h.recalculateStarWidths&&t.columns._updateStarSizes(n.pdf.ptToPx(i.width));this._draw(t,i,f,e,o,h)}finally{h.recalculateStarWidths&&t.invalidate(!0)}},i.export=function(t,i,r){var e,f;n.assert(!!t,'The flex argument cannot be null.');n.assert(!!i,'The fileName argument cannot be empty.');r=u({},r);u(r,this.DefaultExportSettings);e=r.documentOptions.ended;r.documentOptions.ended=function(t,r){e&&e.apply(f,[t,r])===!1||n.pdf.saveBlob(r.blob,i)};f=new n.pdf.PdfDocument(r.documentOptions);try{r.recalculateStarWidths&&t.columns._updateStarSizes(n.pdf.ptToPx(f.width));this._draw(t,f,null,null,null,r);f.end()}finally{r.recalculateStarWidths&&t.invalidate(!0)}},i._draw=function(t,i,r,u,e,o){var d=r!=null,h=new n.Size(i.width,i.height),s,k;r||(r=new n.Point(0,i.y));n.isArray(o.embeddedFonts)&&o.embeddedFonts.forEach(function(n){i.registerFont(n)});var b=f.getSelection(t,o.exportMode),a=this._getGridRenderer(t,b,!1,this.BorderWidth,null,!0),c=new n.Rect(r.x||0,r.y||0,u||h.width,e||h.height),l=this._getScaleFactor(a,o.scaleMode,c),v=this._getPages(a,b,c,o,d,l);for(s=0;s<v.length;s++){s>0&&i.addPage();var y=v[s],p=y.pageCol===0?c.left:0,w=y.pageRow===0?c.top:0;i.saveState();i.paths.rect(0,0,h.width,h.height).clip();i.scale(l,l,new n.Point(p,w));i.translate(p,w);k=this._getGridRenderer(t,y.range,o.repeatMergedValuesAcrossPages,this.BorderWidth,o.styles,s===v.length-1);k.render(i);i.restoreState();i.x=p;i.y=w+a.renderSize.height*l}},i._getScaleFactor=function(n,t,i){var f=1,e,u;return t===r.ActualSize?f:(e=n.renderSize,t===r.SinglePage?(u=Math.min(i.width/e.width,i.height/e.height),u<1&&(f=u)):(u=i.width/e.width,u<1&&(f=u)),f)},i._getPages=function(t,i,u,f,e,o){var ht=this,h=[],l=[],w=n.pdf.pxToPt,b=t.flex,nt=t.showColumnHeader,tt=t.showRowHeader,k=nt?w(b.columnHeaders.height):0,d=tt?w(b.rowHeaders.width):0,yt=f.scaleMode===r.ActualSize||f.scaleMode===r.PageWidth,pt=f.scaleMode===r.ActualSize,wt=(u.width-u.left)*(1/o),bt=(u.height-u.top)*(1/o),kt=u.width*(1/o),dt=u.height*(1/o),v=k,y=d,ct=e&&f.scaleMode==r.ActualSize,it,rt,ut,ft,g,et,s,a,st,vt;if(yt&&(it=0,i.forEach(b.cells,function(n,t,i,r){var f=h.length?dt:bt,u;c.isRenderableRow(n)&&(u=w(n.renderHeight),it++,v+=u,(nt||it>1)&&(v-=ht.BorderWidth),v>f&&(k+u>f||ct?(h.push(r),v=k):(h.push(r-1),v=k+u),nt&&(v-=ht.BorderWidth)))})),rt=i.length()-1,h.length&&h[h.length-1]===rt||h.push(rt),pt)for(ut=0,s=i.leftCol;s<=i.rightCol;s++)ft=b.columns[s],ft.isVisible&&(g=w(ft.renderWidth),et=l.length?kt:wt,ut++,y+=g,(tt||ut>1)&&(y-=this.BorderWidth),y>et&&(d+g>et||ct?(l.push(s),y=d):(l.push(s-1),y=d+g),tt&&(y-=this.BorderWidth)));l.length&&l[l.length-1]===i.rightCol||l.push(i.rightCol);var lt=[],ot=!1,at=1,gt=e&&f.maxPages>0?1:f.maxPages;for(s=0;s<h.length&&!ot;s++)for(a=0;a<l.length&&!ot;a++,at++)(ot=at>gt)||(st=s==0?0:h[s-1]+1,vt=a==0?i.leftCol:l[a-1]+1,lt.push(new p(i.subrange(st,h[s]-st+1,vt,l[a]),a,s)));return lt},i._getGridRenderer=function(n,i,r,u,f,e){var o=t.multirow&&n instanceof t.multirow.MultiRow&&a||t.sheet&&n instanceof t.sheet.FlexSheet&&l||s;return new o(n,i,r,u,f,e)},i.BorderWidth=1,i.DefaultDrawSettings={maxPages:Number.MAX_VALUE,exportMode:o.All,repeatMergedValuesAcrossPages:!0,recalculateStarWidths:!0,styles:{cellStyle:{font:new n.pdf.PdfFont,padding:1.5,verticalAlign:'middle'},headerCellStyle:{font:{weight:'bold'}}}},i.DefaultExportSettings=u({scaleMode:r.PageWidth,documentOptions:{compress:!1,pageSettings:{margins:{left:36,right:36,top:18,bottom:18}}}},i.DefaultDrawSettings),i}();i.FlexGridPdfConverter=h;var s=function(){function i(n,i,r,u,o,s){this._flex=n;this._borderWidth=u;this._lastPage=s;this._topLeft=new e(this,n.topLeftCells,this.showRowHeader&&this.showColumnHeader?new f(n,[new t.CellRange(0,0,n.topLeftCells.rows.length-1,n.topLeftCells.columns.length-1)]):new f(n,[]),r,u,o);this._rowHeader=new e(this,n.rowHeaders,this.showRowHeader?i.clone(0,n.rowHeaders.columns.length-1):new f(n,[]),r,u,o);this._columnHeader=new e(this,n.columnHeaders,this.showColumnHeader?new f(n,[new t.CellRange(0,i.leftCol,n.columnHeaders.rows.length-1,i.rightCol)]):new f(n,[]),r,u,o);this._cells=new e(this,n.cells,i,r,u,o);this._bottomLeft=new e(this,n.bottomLeftCells,this.showRowHeader&&this.showColumnFooter?new f(n,[new t.CellRange(0,0,n.bottomLeftCells.rows.length-1,n.bottomLeftCells.columns.length-1)]):new f(n,[]),r,u,o);this._columnFooter=new e(this,n.columnFooters,this.showColumnFooter?new f(n,[new t.CellRange(0,i.leftCol,n.columnFooters.rows.length-1,i.rightCol)]):new f(n,[]),r,u,o)}return i.prototype.render=function(n){var i=Math.max(0,this._rowHeader.renderSize.width-this._borderWidth),t=Math.max(0,this._columnHeader.renderSize.height-this._borderWidth);this._topLeft.render(n,0,0);this._rowHeader.render(n,0,t);this._columnHeader.render(n,i,0);this._cells.render(n,i,t);t=Math.max(0,t+this._cells.renderSize.height-this._borderWidth);this._bottomLeft.render(n,0,t);this._columnFooter.render(n,i,t)},Object.defineProperty(i.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"renderSize",{get:function(){var t=this._columnHeader.renderSize.height+this._cells.renderSize.height+this._columnFooter.renderSize.height,i=this._rowHeader.renderSize.width+this._cells.renderSize.width;return this._columnHeader.visibleRows>0&&(t-=this._borderWidth),this._columnFooter.visibleRows>0&&(t-=this._borderWidth),this._rowHeader.visibleColumns>0&&(i-=this._borderWidth),new n.Size(i,t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showColumnHeader",{get:function(){return!!(this._flex.headersVisibility&t.HeadersVisibility.Column)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showRowHeader",{get:function(){return!!(this._flex.headersVisibility&t.HeadersVisibility.Row)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showColumnFooter",{get:function(){return this._lastPage&&this._flex.columnFooters.rows.length>0},enumerable:!0,configurable:!0}),i.prototype.getCellValue=function(n,t,i){return n.getCellData(i,t,!0)},i.prototype.getColumn=function(n,t){return n.columns[t]},i.prototype.isAlternatingRow=function(n){return n.index%2!=0},i.prototype.isMergeableCell=function(n,i){return i.allowMerging||n.allowMerging||i instanceof t.GroupRow},i}(),l=function(n){function i(t,i,r,u,f,e){n.call(this,t,i,r,u,f,e)}return __extends(i,n),i.prototype.getCellValue=function(i,r,u){return i.cellType===t.CellType.Cell?i.rows[u]instanceof t.sheet.HeaderRow?this.flex.columnHeaders.getCellData(u,r,!0):this.flex.getCellValue(u,r,!0):n.prototype.getCellValue.call(this,i,r,u)},Object.defineProperty(i.prototype,"showColumnHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showRowHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showColumnFooter",{get:function(){return!1},enumerable:!0,configurable:!0}),i}(s),a=function(n){function i(t,i,r,u,f,e){n.call(this,t,i,r,u,f,e)}return __extends(i,n),i.prototype.getColumn=function(n,t,i){return this.flex.getBindingColumn(n,i,t)},i.prototype.isAlternatingRow=function(i){return i instanceof t.multirow._MultiRow?i.dataIndex%2!=0:n.prototype.isAlternatingRow.call(this,i)},i.prototype.isMergeableCell=function(){return!0},i}(s),c=function(){function i(n,t){this._panel=n;this._range=t.clone()}return i.isRenderableRow=function(n){return n.isVisible&&!(n instanceof t._NewRowTemplate)},Object.defineProperty(i.prototype,"visibleRows",{get:function(){var n=this;return this._visibleRows==null&&(this._visibleRows=0,this._range.forEach(this._panel,function(t){n.isRenderableRow(t)&&n._visibleRows++})),this._visibleRows},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visibleColumns",{get:function(){if(this._visibleColumns==null&&(this._visibleColumns=0,this._range.isValid))for(var n=this._range.leftCol;n<=this._range.rightCol;n++)this._panel.columns[n].isVisible&&this._visibleColumns++;return this._visibleColumns},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){if(this._size==null){var t=this._range.getRenderSize(this._panel);this._size=new n.Size(n.pdf.pxToPt(t.width),n.pdf.pxToPt(t.height))}return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0}),i.prototype.isRenderableRow=function(n){return i.isRenderableRow(n)},i}(),e=function(i){function r(n,t,r,u,f,e){i.call(this,t,r);this._gr=n;this._repeatMergedValues=u;this._borderWidth=f;this._styles=e}return __extends(r,i),Object.defineProperty(r.prototype,"gr",{get:function(){return this._gr},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderSize",{get:function(){return this._renderSize==null&&(this._renderSize=this.size.clone(),this.visibleColumns>1&&(this._renderSize.width-=this._borderWidth*(this.visibleColumns-1)),this.visibleRows>1&&(this._renderSize.height-=this._borderWidth*(this.visibleRows-1))),this._renderSize},enumerable:!0,configurable:!0}),r.prototype.getRangeWidth=function(t,i){for(var e,r=0,u=0,o=this.panel,f=t;f<=i;f++)e=o.columns[f],e.isVisible&&(u++,r+=e.renderWidth);return r=n.pdf.pxToPt(r),u>1&&(r-=this._borderWidth*(u-1)),r},r.prototype.getRangeHeight=function(t,i){for(var e,r=0,u=0,o=this.panel,f=t;f<=i;f++)e=o.rows[f],this.isRenderableRow(e)&&(u++,r+=e.renderHeight);return r=n.pdf.pxToPt(r),u>1&&(r=r-this._borderWidth*(u-1)),r},r.prototype.render=function(n,t,i){var r=this,u=this.range,o=this.panel,s=new v(this._gr.flex),f,e;if(u.isValid){for(f={},e=u.leftCol;e<=u.rightCol;e++)f[e]=i;u.forEach(o,function(i,e,h){var k,c,y,l,b;if(r.isRenderableRow(i))for(k=t,c=u.leftCol;c<=u.rightCol;c++){var d=r.gr.getColumn(o,c,h),p=undefined,a=undefined,v=undefined,w=undefined;if(d.isVisible){if(y=r._getCellValue(c,h),r.gr.isMergeableCell(d,i)&&(l=s.getMergedRange(o,h,c)))if(l.topRow!==l.bottomRow)l.firstVisibleRow===h||h===e.topRow?p={value:r._repeatMergedValues?y:l.firstVisibleRow===h?y:'',height:a=r.getRangeHeight(h,Math.min(l.bottomRow,e.bottomRow)),width:v=r.getRangeWidth(c,c)}:v=r.getRangeWidth(c,c);else for(p={value:r._repeatMergedValues?y:c===l.leftCol?y:'',height:a=r.getRangeHeight(h,h),width:v=r.getRangeWidth(Math.max(u.leftCol,l.leftCol),Math.min(u.rightCol,l.rightCol))},w=Math.min(u.rightCol,l.rightCol),b=c+1;b<=w;b++)f[b]+=a-r._borderWidth;else p={value:y,height:a=r.getRangeHeight(h,h),width:v=r.getRangeWidth(c,c)};p&&r._renderCell(n,p,i,d,h,c,k,f[c]);a&&(f[c]+=a-r._borderWidth);v&&(k+=v-r._borderWidth);w&&(c=w)}}})}},r.prototype._getCellValue=function(n,i){var u=this.panel,f=this.gr.getCellValue(u,n,i),r,e,o;return f||f===0||u.cellType!==t.CellType.Cell||(r=u.rows[i],r instanceof t.GroupRow&&r.dataItem&&r.dataItem.groupDescription&&n===u.columns.firstVisibleIndex&&(e=r.dataItem.groupDescription.propertyName,o=u.columns.getColumn(e),o&&o.header&&(e=o.header),f=e+': '+r.dataItem.name+' ('+r.dataItem.items.length+' items)')),f},r.prototype._isGroupRow=function(n){return n instanceof t.GroupRow&&n.hasChildren},r.prototype._renderCell=function(i,r,f,e,o,s,h,c){var a=u({},this._styles.cellStyle),p=this.panel,l,v,y;switch(p.cellType){case t.CellType.Cell:this._isGroupRow(f)?u(a,this._styles.groupCellStyle,!0):this.gr.isAlternatingRow(f)&&u(a,this._styles.altCellStyle,!0);break;case t.CellType.ColumnHeader:case t.CellType.RowHeader:case t.CellType.TopLeft:case t.CellType.BottomLeft:u(a,this._styles.headerCellStyle,!0);break;case t.CellType.ColumnFooter:u(a,this._styles.headerCellStyle,!0);u(a,this._styles.footerCellStyle,!0)}if(l=a,a.font&&((v=a.font.family)&&(l.fontFamily=v),(v=a.font.size)&&(l.fontSize=v),(v=a.font.style)&&(l.fontStyle=v),(v=a.font.weight)&&(l.fontWeight=v),a.font=undefined),f instanceof t.GroupRow&&!e.aggregate||(l.textAlign=e.getAlignment()),l.left=h,l.top=c,l.width=r.width,l.height=r.height,l.boxSizing='no-box',l.borderWidth=this._borderWidth,l.borderStyle='solid',y=p.grid,p.cellType===t.CellType.Cell&&y.rows.maxGroupLevel>=0&&s===y.columns.firstVisibleIndex){var w=f instanceof t.GroupRow?Math.max(f.level,0):y.rows.maxGroupLevel+1,b=n.pdf._asPt(l.paddingLeft||l.padding),k=n.pdf.pxToPt(w*y.treeIndent);l.paddingLeft=b+k}e.dataType===n.DataType.Boolean&&p.cellType===t.CellType.Cell&&!this._isGroupRow(f)&&this._isBoolean(r.value)?i._renderBooleanCell(r.value,l):i._renderTextCell(r.value,l)},r.prototype._isBoolean=function(t){var i=n.isString(t)&&t.toLowerCase();return i==='true'||i==='false'||t===!0||t===!1},r}(c),v=function(){function n(n){this._columns={};this._flex=n}return n.prototype.getMergedRange=function(n,t,i){var r=this._columns[i],u;return r&&t>=r.topRow&&t<=r.bottomRow?r:(u=this._flex.getMergedRange(n,t,i,!1),this._columns[i]=u?new y(n,u):null)},n}(),y=function(n){function t(t,i){var u,f,r;for(n.call(this,i.row,i.col,i.row2,i.col2),this.firstVisibleRow=-1,u=this.topRow,f=this.bottomRow,r=u;r<f;r++)if(t.rows[r].isVisible){this.firstVisibleRow=r;break}}return __extends(t,n),t}(t.CellRange),f=function(){function i(n,t){this._flex=n;this._ranges=t||[]}return i.getSelection=function(n,r){var f=[],s,e,u,h;if(r===o.All)f.push(new t.CellRange(0,0,n.rows.length-1,n.columns.length-1));else{s=n.selection;switch(n.selectionMode){case t.SelectionMode.Cell:case t.SelectionMode.CellRange:f.push(s);break;case t.SelectionMode.Row:f.push(new t.CellRange(s.topRow,0,s.topRow,n.cells.columns.length-1));break;case t.SelectionMode.RowRange:f.push(new t.CellRange(s.topRow,0,s.bottomRow,n.cells.columns.length-1));break;case t.SelectionMode.ListBox:for(e=-1,u=0;u<n.rows.length;u++)h=n.rows[u],h.isSelected?(e<0&&(e=u),u===n.rows.length-1&&f.push(new t.CellRange(e,0,u,n.cells.columns.length-1))):(e>=0&&f.push(new t.CellRange(e,0,u-1,n.cells.columns.length-1)),e=-1)}}return new i(n,f)},i.prototype.length=function(){for(var n,i=0,t=0;t<this._ranges.length;t++)n=this._ranges[t],n.isValid&&(i+=n.bottomRow-n.topRow+1);return i},Object.defineProperty(i.prototype,"isValid",{get:function(){return this._ranges.length&&this._ranges[0].isValid},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"leftCol",{get:function(){return this._ranges.length?this._ranges[0].leftCol:-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rightCol",{get:function(){return this._ranges.length?this._ranges[0].rightCol:-1},enumerable:!0,configurable:!0}),i.prototype.clone=function(n,t){for(var r,f=[],u=0;u<this._ranges.length;u++)r=this._ranges[u].clone(),arguments.length>0&&(r.col=n),arguments.length>1&&(r.col2=t),f.push(r);return new i(this._flex,f)},i.prototype.getRenderSize=function(t){for(var u,i=new n.Size(0,0),r=0;r<this._ranges.length;r++)u=this._ranges[r].getRenderSize(t),i.width=Math.max(i.width,u.width),i.height+=u.height;return i},i.prototype.forEach=function(n,t){for(var i,r,f=0,u=0;u<this._ranges.length;u++)if(i=this._ranges[u],i.isValid)for(r=i.topRow;r<=i.bottomRow;r++)t(n.rows[r],i,r,f++)},i.prototype.subrange=function(n,r,u,f){var l=[],o,s,h,e;if(n>=0&&r>0)for(o=0,s=0,h=0;h<this._ranges.length&&r>0;h++,o=s+1)if(e=this._ranges[h],s=o+(e.bottomRow-e.topRow),!(n>s)){var c=n>o?e.topRow+(n-o):e.topRow,a=Math.min(e.bottomRow,c+r-1),v=arguments.length>2?u:e.leftCol,y=arguments.length>2?f:e.rightCol;l.push(new t.CellRange(c,v,a,y));r-=a-c+1}return new i(this._flex,l)},i}(),p=function(){function n(n,t,i){this._col=t;this._row=i;this._range=n}return Object.defineProperty(n.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageCol",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageRow",{get:function(){return this._row},enumerable:!0,configurable:!0}),n}()})(i=t.pdf||(t.pdf={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={}))